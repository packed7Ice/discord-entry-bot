<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="description" content="QRã‚³ãƒ¼ãƒ‰ã‚¹ã‚­ãƒ£ãƒŠãƒ¼ - Discordé€£æº">
    <title>discord-entry-bot - ã‚¹ã‚­ãƒ£ãƒŠãƒ¼</title>
    <link rel="stylesheet" href="/style.css">
</head>

<body>
    <div class="theme-toggle" onclick="toggleTheme()" title="ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆ">
        <span class="theme-icon">ğŸŒ™</span>
    </div>

    <div class="container scanner-container">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <header class="header">
            <a href="/dashboard" style="text-decoration: none; color: inherit;">
                <h1>â† QR Scanner</h1>
            </a>
            <div class="user-info">
                <span id="username">---</span>
                <a href="/auth/logout" class="btn-logout">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</a>
            </div>
        </header>

        <!-- ã‚¹ã‚­ãƒ£ãƒŠãƒ¼é ˜åŸŸ -->
        <div class="scanner-wrapper">
            <video id="video" autoplay playsinline></video>
            <canvas id="canvas" hidden></canvas>
            <div class="scanner-overlay">
                <div class="scanner-frame"></div>
            </div>
        </div>

        <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º -->
        <div id="status" class="status status-ready">
            <span class="status-icon">ğŸ“·</span>
            <span class="status-text">ã‚«ãƒ¡ãƒ©ã‚’èµ·å‹•ä¸­...</span>
        </div>

        <!-- çµæœè¡¨ç¤º -->
        <div id="result" class="result hidden">
            <div class="result-icon"></div>
            <div class="result-text"></div>
        </div>

        <!-- ã‚¨ãƒ©ãƒ¼è¡¨ç¤º -->
        <div id="error" class="error hidden">
            <p class="error-text"></p>
            <button onclick="location.reload()" class="btn btn-retry">å†è©¦è¡Œ</button>
        </div>
    </div>

    <!-- jsQR ãƒ©ã‚¤ãƒ–ãƒ©ãƒª (CDN) -->
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
    <script src="/scanner.js"></script>
    <script>
        // ãƒ†ãƒ¼ãƒç®¡ç†
        function getPreferredTheme() {
            const saved = localStorage.getItem('theme');
            if (saved) return saved;
            return window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark';
        }
        function setTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            document.querySelector('.theme-icon').textContent = theme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸';
        }
        function toggleTheme() {
            const current = document.documentElement.getAttribute('data-theme') || 'dark';
            setTheme(current === 'dark' ? 'light' : 'dark');
        }
        setTheme(getPreferredTheme());
    </script>
</body>

</html>