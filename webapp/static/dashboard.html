<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="description" content="discord-entry-bot ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰">
    <title>discord-entry-bot</title>
    <link rel="stylesheet" href="/style.css">
</head>

<body>
    <div class="theme-toggle" onclick="toggleTheme()" title="ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆ">
        <span class="theme-icon">ğŸŒ™</span>
    </div>

    <div class="container dashboard">
        <div class="logo">ğŸ“±</div>
        <h1>discord-entry-bot</h1>
        <p class="subtitle">QRã‚³ãƒ¼ãƒ‰ã‚¹ã‚­ãƒ£ãƒŠãƒ¼ & é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ </p>

        <div class="menu">
            <a href="/scanner" class="menu-item">
                <span class="menu-icon">ğŸ“·</span>
                <span class="menu-label">QRã‚¹ã‚­ãƒ£ãƒŠãƒ¼</span>
                <span class="menu-desc">ã‚«ãƒ¡ãƒ©ã§QRã‚³ãƒ¼ãƒ‰ã‚’ã‚¹ã‚­ãƒ£ãƒ³</span>
            </a>
        </div>

        <div class="user-info" id="userInfo">
            <span class="user-name"></span>
            <a href="/auth/logout" class="logout-btn">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</a>
        </div>
    </div>

    <script>
        // ãƒ†ãƒ¼ãƒç®¡ç†
        function getPreferredTheme() {
            const saved = localStorage.getItem('theme');
            if (saved) return saved;
            return window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark';
        }

        function setTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            document.querySelector('.theme-icon').textContent = theme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸';
        }

        function toggleTheme() {
            const current = document.documentElement.getAttribute('data-theme') || 'dark';
            setTheme(current === 'dark' ? 'light' : 'dark');
        }

        // åˆæœŸãƒ†ãƒ¼ãƒè¨­å®š
        setTheme(getPreferredTheme());

        // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—
        fetch('/auth/me')
            .then(res => res.json())
            .then(data => {
                if (data.logged_in && data.user) {
                    document.querySelector('.user-name').textContent = data.user.username;
                    document.getElementById('userInfo').style.display = 'flex';
                }
            });
    </script>
</body>

</html>